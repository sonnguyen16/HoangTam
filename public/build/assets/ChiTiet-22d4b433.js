import{Q as S,h as L,T,z as B,u as n,o as l,c as d,a as t,w as g,f as v,B as N,m as p,t as _,F as f,k as y,l as u,e as b,n as F,x as V,y as I}from"./app-a0d3c948.js";import{f as D}from"./script-4eb152de.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";const o=h=>(V("data-v-ea38d198"),h=h(),I(),h),E={class:"d-flex align-items-center"},M=o(()=>t("p",{class:"text-secondary mb-0"},"Trạng thái: ",-1)),U=["disabled"],z=o(()=>t("option",{value:"0"},"Chưa duyệt",-1)),O=o(()=>t("option",{value:"1"},"Đã duyệt",-1)),Q=[z,O],q=o(()=>t("h5",{class:"mb-0 mt-2"},"Thông tin đề xuất",-1)),G=o(()=>t("hr",{class:"mt-2 mb-3"},null,-1)),H={class:"text-secondary"},J={class:"text-md"},K=o(()=>t("i",{class:"fa fa-user me-2"},null,-1)),P={class:"font-weight-bold text-black ms-2 text-md"},R={class:"text-md mb-2"},W=o(()=>t("i",{class:"fa fa-clock me-2"},null,-1)),X={class:"ms-2 text-md text-black"},Y={class:"d-flex"},Z=o(()=>t("span",{class:"text-md me-1 mt-2"},[t("i",{class:"fa fa-file flex-1 me-2"}),p(" Nội dung: ")],-1)),tt=o(()=>t("h5",{class:"mb-0 mt-3"},"File đính kèm",-1)),et=o(()=>t("hr",{class:"mt-2 mb-3"},null,-1)),st={class:"mt-3"},nt={class:"d-flex align-items-center mb-2"},ot=o(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success mt-2"},"Attachments:",-1)),at=o(()=>t("label",{for:"files2",class:"btn btn-success btn-sm mt-2 ml-3"},"Chọn file",-1)),lt=o(()=>t("span",{id:"fileList",class:"d-inline-block ml-3"},null,-1)),dt={key:0,class:"row"},it={class:"col-md-5"},ct={class:"card"},_t={class:"card-body p-0"},rt={class:"table table-striped"},ut=o(()=>t("thead",null,[t("tr",null,[t("th",null,"File"),t("th",null,"Actions")])],-1)),ht={style:{width:"90%"}},pt=["href"],mt={key:0,class:"fa fa-image"},gt={key:1,class:"fa fa-file-pdf"},ft={key:2,class:"fa fa-file-excel"},bt={key:1},xt={style:{width:"10%"},class:"text-center"},vt=["onClick"],yt=o(()=>t("i",{class:"fa fa-trash"},null,-1)),kt=[yt],wt=["disabled"],jt={class:"mb-0 mt-3"},Ct=o(()=>t("hr",{class:"mt-2 mb-3"},null,-1)),St={class:"card elevation-2"},Lt={class:"card-body"},Tt=["src"],Bt={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 object-cover"},Nt=["value"],Ft=o(()=>t("input",{id:"comment",class:"form-control border-0 flex-1",placeholder:"Nhập bình luận"},null,-1)),Vt=o(()=>t("button",{type:"submit",class:""},[t("i",{class:"fa fa-paper-plane text-lg text-primary"})],-1)),It={style:{"max-height":"150px",overflow:"auto"}},Dt={class:""},$t={class:"d-flex"},At=["src"],Et={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},Mt={class:"flex-1 ml-3"},Ut={class:"d-flex justify-content-between"},zt={class:"font-weight-bold"},Ot={class:"text-secondary"},Qt={class:"text-md"},qt={__name:"ChiTiet",props:{de_xuat_selected:Object},setup(h){const c=h,m=S();let r=L([]),s=T({id:"",ten:"",noi_dung:"",created_at:"",trang_thai:0,created_by:{},files:[],binh_luan:[]});B(()=>{s.id=c.de_xuat_selected.id,s.ten=c.de_xuat_selected.ten,s.noi_dung=c.de_xuat_selected.noi_dung,s.files=c.de_xuat_selected.files,s.created_at=c.de_xuat_selected.created_at,s.created_by=c.de_xuat_selected.created_by,s.binh_luan=c.de_xuat_selected.binh_luan,s.trang_thai=c.de_xuat_selected.trang_thai,r.value=c.de_xuat_selected.files.map(a=>({id:a.id,ten:a.ten,ten_goc:a.ten_goc}))});const k=()=>{s.post(route("dexuat.store"),{onSuccess:()=>{toastr.success("Lưu đề xuất thành công")},onError:()=>{toastr.error("Lưu đề xuất thất bại"),console.log(s.errors)}})},w=a=>{confirm("Bạn có chắc chắn muốn xóa file này không?")&&(s.files=s.files.filter(i=>i.id!=a),r.value=r.value.filter(i=>i.id!=a),axios({method:"delete",url:route("duan.file.delete",{id:a})}))};function j(a){s.files=a.target.files,r.value=[...r.value,...Array.from(a.target.files).map(i=>({ten:i.name}))]}function C(){axios({method:"post",url:route("binhluan.store"),data:{noi_dung:$("#comment").val(),de_xuat_id:s.id}}).then(a=>{$("#comment").val(""),s.binh_luan.push({noi_dung:a.data.noi_dung,nguoi_dung:a.data.nguoi_dung,created_at:a.data.created_at})}).catch(a=>{console.log(a)})}return(a,i)=>n(s).id?(l(),d(f,{key:0},[t("form",{onSubmit:b(k,["prevent"])},[g(t("input",{class:"w-100 font-weight-bold border-0 text-[20px] active:outline-0 p-0","onUpdate:modelValue":i[0]||(i[0]=e=>n(s).ten=e)},null,512),[[v,n(s).ten]]),t("div",E,[M,g(t("select",{disabled:c.de_xuat_selected.nguoi_duyet.id!=n(m).props.user.id,"onUpdate:modelValue":i[1]||(i[1]=e=>n(s).trang_thai=e),class:"form-control w-25 border-0"},Q,8,U),[[N,n(s).trang_thai]])]),q,G,t("div",H,[t("p",J,[K,p(" Người tạo: "),t("span",P,_(n(s).created_by.name),1)]),t("p",R,[W,p(" Ngày tạo: "),t("span",X,_(n(D)(n(s).created_at)),1)]),t("div",Y,[Z,g(t("textarea",{rows:"5","onUpdate:modelValue":i[2]||(i[2]=e=>n(s).noi_dung=e),class:"text-md text-black form-control w-75 border-0"},null,512),[[v,n(s).noi_dung]])])]),tt,et,t("div",st,[t("div",nt,[ot,at,t("input",{accept:".png, .jpg, .jpeg, .gif, .bmp, .doc, .docx, .xls, .xlsx, .pdf",type:"file",onInput:i[3]||(i[3]=e=>j(e)),id:"files2",class:"d-none",multiple:""},null,32),lt]),n(r).length>0?(l(),d("div",dt,[t("div",it,[t("div",ct,[t("div",_t,[t("table",rt,[ut,t("tbody",null,[(l(!0),d(f,null,y(n(r),e=>{var x;return l(),d("tr",{key:e.id},[t("td",ht,[e.id?(l(),d("a",{key:0,href:`/uploads/de_xuat/${e.ten}`,target:"_blank",class:""},[e.ten.split(".")[e.ten.split(".").length-1]==="png"||e.ten.split(".")[e.ten.split(".").length-1]==="jpg"?(l(),d("i",mt)):u("",!0),e.ten.split(".")[e.ten.split(".").length-1]==="pdf"||e.ten.split(".")[e.ten.split(".").length-1]==="docx"?(l(),d("i",gt)):u("",!0),e.ten.split(".")[e.ten.split(".").length-1]==="xlsx"?(l(),d("i",ft)):u("",!0),p(" "+_(((x=e.ten_goc)==null?void 0:x.length)>30?e.ten_goc.slice(0,30)+"...":e.ten_goc),1)],8,pt)):(l(),d("span",bt,_(e.ten),1))]),t("td",xt,[e.id?(l(),d("a",{key:0,onClick:b(Gt=>w(e.id),["prevent"]),class:"btn btn-sm btn-danger"},kt,8,vt)):u("",!0)])])}),128))])])])])])])):u("",!0),t("button",{disabled:n(s).processing,type:"submit",class:"btn btn-primary font-weight-bold right-0"},"Lưu",8,wt)])],32),t("h5",jt,"Bình luận ("+_(n(s).binh_luan.length)+")",1),Ct,t("div",St,[t("div",Lt,[t("div",{class:F(["d-flex",{"mb-4":n(s).binh_luan.length>0}])},[n(m).props.user.hinh_anh?(l(),d("img",{key:0,src:"/uploads/nhan_vien/"+n(m).props.user.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,Tt)):(l(),d("img",Bt)),t("form",{onSubmit:b(C,["prevent"]),class:"flex-1 d-flex"},[t("input",{type:"hidden",value:n(s).id},null,8,Nt),Ft,Vt],32)],2),t("div",It,[(l(!0),d(f,null,y(n(s).binh_luan,e=>(l(),d("div",Dt,[t("div",$t,[e.nguoi_dung.hinh_anh?(l(),d("img",{key:0,src:"/uploads/nhan_vien/"+e.nguoi_dung.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,At)):(l(),d("img",Et)),t("div",Mt,[t("div",Ut,[t("span",zt,_(e.nguoi_dung.name),1),t("span",Ot,_(new Date(e.created_at).toLocaleString()),1)]),t("p",Qt,_(e.noi_dung),1)])])]))),256))])])])],64)):u("",!0)}},Pt=A(qt,[["__scopeId","data-v-ea38d198"]]);export{Pt as default};
