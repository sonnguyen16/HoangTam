import{h as I,E as N,o as l,c as o,a as t,n as k,D as B,l as m,e as g,u as c,m as V,t as _,F as w,k as C,b as E,x as L,y as M,Q as z,T as D,z as H,w as v,f as y,O as K}from"./app-b43ce174.js";/* empty css                                                                 */import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";const U=s=>(L("data-v-7457ba01"),s=s(),M(),s),Q={class:"row mb-3"},q={key:0,class:"vertical-line"},G={class:"col-lg-2 d-lg-block d-none"},J={class:"col-lg-2 d-lg-block d-none"},P={class:"col-lg-2 d-lg-block d-none"},R={key:0,class:"badge badge-warning"},W={key:1,class:"badge badge-primary"},X={key:2,class:"badge badge-success"},Y={class:"col-lg-2 d-lg-block d-none"},Z={class:"col-lg-1 col-3"},tt=U(()=>t("i",{class:"fa fa-plus text-neutral-500 mr-3"},null,-1)),et=[tt],nt=U(()=>t("i",{class:"fa fa-edit text-neutral-500"},null,-1)),st=[nt],lt={__name:"TreeItem",props:{item:Object,isChild:{type:Boolean,default:!1},level:{type:Number,default:0}},emits:["edit","add"],setup(s,{emit:j}){let p=I(!0);const d=j;function h(){p.value=!p.value}return(n,r)=>{var x;const T=N("TreeItem",!0);return l(),o("div",null,[t("div",Q,[t("div",{class:k(["col-lg-3 col-9",{"child-container":s.isChild}]),style:B({paddingLeft:`${s.level*15}px`})},[t("span",{style:B({width:`${s.level*15}px`}),class:"line-connector"},null,4),s.isChild?(l(),o("span",q)):m("",!0),t("a",{onClick:g(h,["prevent"]),class:k([s.item.children?"cursor-pointer":"cursor-text","mb-2 text-black"])},[s.item.children?(l(),o("i",{key:0,class:k(["fa fa-folder mr-2 text-amber-400 text-lg",c(p)?"fa-folder-open":"fa-folder-closed"])},null,2)):m("",!0),V(" "+_(s.item.ten),1)],2)],6),t("div",G,[t("span",null,_(s.item.ngay_bat_dau),1)]),t("div",J,[t("span",null,_(s.item.ngay_ket_thuc),1)]),t("div",P,[t("span",null,[s.item.trang_thai==0?(l(),o("span",R,"Chưa thực hiện")):s.item.trang_thai==1?(l(),o("span",W,"Đang thực hiện")):s.item.trang_thai==2?(l(),o("span",X,"Đã hoàn thành")):m("",!0)])]),t("div",Y,[t("span",null,_((x=s.item.nhan_vien)==null?void 0:x.name),1)]),t("div",Z,[t("a",{onClick:r[0]||(r[0]=g(b=>{d("add",s.item.id)},["prevent"]))},et),t("a",{onClick:r[1]||(r[1]=g(b=>{d("edit",s.item)},["prevent"]))},st)])]),t("div",null,[c(p)?(l(!0),o(w,{key:0},C(s.item.children,b=>(l(),E(T,{"is-child":!0,level:s.level+1,key:b.id,item:b,onEdit:r[2]||(r[2]=f=>n.$emit("edit",f)),onAdd:r[3]||(r[3]=f=>n.$emit("add",f))},null,8,["level","item"]))),128)):m("",!0)])])}}},at=O(lt,[["__scopeId","data-v-7457ba01"]]);const u=s=>(L("data-v-176ddcdd"),s=s(),M(),s),ot={id:"chitietdamodal",class:"modal fade",tabindex:"-1",style:{"z-index":"1051"},role:"dialog"},dt={class:"modal-dialog modal-xl",role:"document"},it={class:"modal-content"},ct={class:"modal-header"},ut=u(()=>t("i",{class:"fa fa-times text-lg"},null,-1)),rt=[ut],_t={class:"modal-body"},ht={class:"d-flex align-items-center"},mt=u(()=>t("label",{for:"ngay_bat_dau",class:"font-weight-bold text-secondary mt-2"},"Bắt đầu:",-1)),gt=u(()=>t("label",{for:"ngay_ket_thuc",class:"font-weight-bold text-secondary mt-2"},"Kết thúc:",-1)),pt=u(()=>t("label",{for:"user",class:"font-weight-bold text-secondary mt-2"},"Tiến độ(%):",-1)),bt={class:"mt-3"},ft=u(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success"},"Mô tả hạng mục:",-1)),vt={class:"mt-3"},yt={class:"d-flex align-items-center mb-2"},xt=u(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success mt-2"},"Attachments:",-1)),kt=u(()=>t("label",{for:"files1",class:"btn btn-dark btn-sm mt-2 ml-3"},"Chọn file",-1)),$t=u(()=>t("span",{id:"fileList",class:"d-inline-block ml-3"},null,-1)),wt={key:0,class:"row"},Ct={class:"col-md-4"},jt={class:"card"},Tt={class:"card-body p-0"},It={class:"table table-striped"},St=u(()=>t("thead",null,[t("tr",null,[t("th",null,"File"),t("th",null,"Actions")])],-1)),Bt=["href"],Vt={key:0,class:"fa fa-image"},Et={key:1,class:"fa fa-file-pdf"},Lt={key:2,class:"fa fa-file-excel"},Mt={key:1},Ot={class:"d-flex gap-[5px] justify-content-center"},Ut=["onClick"],At=u(()=>t("i",{class:"fa fa-trash"},null,-1)),Ft=[At],Nt=["disabled"],zt=u(()=>t("hr",null,null,-1)),Dt={class:"mt-4 mb-4",id:"subtasks"},Ht=u(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success"},"Hạng mục con:",-1)),Kt={class:"mt-3 container"},Qt=u(()=>t("hr",null,null,-1)),qt={id:"comments",class:"mt-4"},Gt={class:"font-weight-bold"},Jt={class:"card"},Pt={class:"card-body"},Rt=["src"],Wt={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 object-cover"},Xt=["value"],Yt=u(()=>t("input",{id:"comment",class:"form-control border-0 flex-1",placeholder:"Nhập bình luận"},null,-1)),Zt=u(()=>t("button",{type:"submit",class:""},[t("i",{class:"fa fa-paper-plane text-lg text-primary"})],-1)),te={style:{"max-height":"200px",overflow:"auto"}},ee={class:""},ne={class:"d-flex"},se=["src"],le={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},ae={class:"flex-1 ml-3"},oe={class:"d-flex justify-content-between"},de={class:"font-weight-bold"},ie={class:"text-secondary"},ce={class:"text-md"},ue=u(()=>t("div",{class:"modal-footer"},null,-1)),re={__name:"ChiTiet",props:{du_an:Object,users:Object},emits:["edit","add"],setup(s,{emit:j}){const p=z(),d=s,h=I([]),n=D({id:"",ten:"",ngay_bat_dau:"",ngay_ket_thuc:"",user_id:"",mo_ta:"",tien_do:0,parent_id:"",children:[],files:[]});H(()=>{n.id=d.du_an.id,n.ten=d.du_an.ten,n.ngay_bat_dau=d.du_an.ngay_bat_dau,n.ngay_ket_thuc=d.du_an.ngay_ket_thuc,n.user_id=d.du_an.user_id,$("#user").val(d.du_an.user_id).trigger("change"),n.mo_ta=d.du_an.mo_ta,n.tien_do=d.du_an.tien_do,n.parent_id=d.du_an.parent_id,n.children=d.du_an.children,n.files=d.du_an.files,h.value=d.du_an.files});const r=()=>{n.post(route("duan.store"),{onSuccess:()=>{toastr.success("Cập nhật thành công")},onError:()=>{toastr.error("Có lỗi xảy ra, vui lòng thử lại")}})},T=()=>{$("#files1").val(""),$("#chitietdamodal").modal("hide"),n.reset(),n.clearErrors(),K.reload()},x=i=>{confirm("Bạn có chắc chắn muốn xóa file này không?")&&(n.files=n.files.filter(a=>a.id!==i),h.value=h.value.filter(a=>a.id!==i),axios({method:"delete",url:route("duan.file.delete",{id:i})}))};function b(i){n.files=i.target.files,h.value=[...h.value,...Array.from(i.target.files).map(a=>({ten:a.name}))]}I({id:"",ten:"",ngay_bat_dau:"",ngay_ket_thuc:"",user_id:"",nhan_vien:{},mo_ta:"",tien_do:0,parent_id:"",children:[],files:[]});const f=j,A=i=>{f("edit",i)},S=i=>{f("add",i)};function F(){axios({method:"post",url:route("binhluan.store"),data:{noi_dung:$("#comment").val(),du_an_id:d.du_an.id}}).then(i=>{$("#comment").val(""),d.du_an.binh_luan.push({noi_dung:i.data.noi_dung,nguoi_dung:i.data.nguoi_dung,created_at:i.data.created_at})}).catch(i=>{console.log(i)})}return(i,a)=>(l(),o("div",ot,[t("div",dt,[t("div",it,[t("div",ct,[t("button",{type:"button",class:"close",onClick:g(T,["prevent"])},rt)]),t("form",{onSubmit:g(r,["prevent"])},[t("div",_t,[v(t("input",{type:"hidden","onUpdate:modelValue":a[0]||(a[0]=e=>c(n).id=e),id:"id",class:"form-control"},null,512),[[y,c(n).id]]),v(t("input",{type:"text",class:"font-weight-bold border-0 w-100 text-lg pl-0","onUpdate:modelValue":a[1]||(a[1]=e=>c(n).ten=e)},null,512),[[y,c(n).ten]]),t("div",ht,[mt,v(t("input",{type:"date","onUpdate:modelValue":a[2]||(a[2]=e=>c(n).ngay_bat_dau=e),id:"ngay_bat_dau",class:"border-0 mr-5 text-secondary"},null,512),[[y,c(n).ngay_bat_dau]]),gt,v(t("input",{type:"date","onUpdate:modelValue":a[3]||(a[3]=e=>c(n).ngay_ket_thuc=e),id:"ngay_ket_thuc",class:"border-0 mr-5 text-secondary"},null,512),[[y,c(n).ngay_ket_thuc]]),pt,v(t("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>c(n).tien_do=e),class:"border-0 outline-0 font-bold focus:outline-0",type:"number"},null,512),[[y,c(n).tien_do]])]),t("div",bt,[ft,v(t("textarea",{"onUpdate:modelValue":a[5]||(a[5]=e=>c(n).mo_ta=e),id:"mo_ta",class:"form-control border-0 pl-0",rows:"3"},null,512),[[y,c(n).mo_ta]])]),t("div",vt,[t("div",yt,[xt,kt,t("input",{accept:".png, .jpg, .jpeg, .gif, .bmp, .doc, .docx, .xls, .xlsx, .pdf",type:"file",onInput:a[6]||(a[6]=e=>b(e)),id:"files1",class:"d-none",multiple:""},null,32),$t]),h.value.length>0?(l(),o("div",wt,[t("div",Ct,[t("div",jt,[t("div",Tt,[t("table",It,[St,t("tbody",null,[(l(!0),o(w,null,C(h.value,e=>(l(),o("tr",{key:e.id},[t("td",null,[e.id?(l(),o("a",{key:0,href:`/uploads/du_an/${e.ten}`,target:"_blank",class:""},[e.ten.split(".")[e.ten.split(".").length-1]==="png"||e.ten.split(".")[e.ten.split(".").length-1]==="jpg"?(l(),o("i",Vt)):m("",!0),e.ten.split(".")[e.ten.split(".").length-1]==="pdf"||e.ten.split(".")[e.ten.split(".").length-1]==="docx"?(l(),o("i",Et)):m("",!0),e.ten.split(".")[e.ten.split(".").length-1]==="xlsx"?(l(),o("i",Lt)):m("",!0),V(" "+_(e.ten.length>30?e.ten.slice(0,30)+"...":e.ten),1)],8,Bt)):(l(),o("span",Mt,_(e.ten),1))]),t("td",Ot,[e.id?(l(),o("a",{key:0,onClick:g(_e=>x(e.id),["prevent"]),class:"btn btn-sm btn-danger"},Ft,8,Ut)):m("",!0)])]))),128))])])])])])])):m("",!0),t("button",{type:"submit",disabled:c(n).processing,class:"btn btn-primary right-0"},"Lưu",8,Nt),zt,t("div",Dt,[Ht,t("a",{class:"btn btn-primary btn-sm ml-3 font-weight-bold",onClick:a[7]||(a[7]=g(e=>S(s.du_an.id),["prevent"]))},"Thêm"),t("div",Kt,[(l(!0),o(w,null,C(s.du_an.children,e=>(l(),E(at,{class:"",key:e.id,item:e,onEdit:A,onAdd:S},null,8,["item"]))),128))])]),Qt,t("div",qt,[t("p",Gt,"Bình luận ("+_(d.du_an.binh_luan.length)+")",1),t("div",Jt,[t("div",Pt,[t("div",{class:k(["d-flex",{"mb-4":d.du_an.binh_luan.length>0}])},[c(p).props.user.hinh_anh?(l(),o("img",{key:0,src:"/uploads/nhan_vien/"+c(p).props.user.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,Rt)):(l(),o("img",Wt)),t("form",{onSubmit:a[8]||(a[8]=g(e=>F(),["prevent"])),class:"flex-1 d-flex"},[t("input",{type:"hidden",value:d.du_an.id},null,8,Xt),Yt,Zt],32)],2),t("div",te,[(l(!0),o(w,null,C(d.du_an.binh_luan,e=>(l(),o("div",ee,[t("div",ne,[e.nguoi_dung.hinh_anh?(l(),o("img",{key:0,src:"/uploads/nhan_vien/"+e.nguoi_dung.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,se)):(l(),o("img",le)),t("div",ae,[t("div",oe,[t("span",de,_(e.nguoi_dung.name),1),t("span",ie,_(new Date(e.created_at).toLocaleString()),1)]),t("p",ce,_(e.noi_dung),1)])])]))),256))])])])])])]),ue],32)])])]))}},pe=O(re,[["__scopeId","data-v-176ddcdd"]]);export{pe as default};
