import{h as I,E as z,o as l,c as a,a as t,n as k,D as V,l as m,e as g,u as c,m as E,t as r,F as w,k as C,b as L,x as M,y as O,Q as D,T as H,z as K,w as v,f as y,O as Q}from"./app-fd7f12dc.js";/* empty css                                                                 */import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";const A=n=>(M("data-v-54f0f5e6"),n=n(),O(),n),q={class:"row mb-3"},G={key:0,class:"vertical-line"},J={class:"col-lg-2 d-lg-block d-none"},P={class:"col-lg-2 d-lg-block d-none"},R={class:"col-lg-2 d-lg-block d-none"},W={key:0,class:"badge badge-warning"},X={key:1,class:"badge badge-primary"},Y={key:2,class:"badge badge-success"},Z={class:"col-lg-2 d-lg-block d-none"},tt={class:"col-lg-1 col-3"},et=A(()=>t("i",{class:"fa fa-plus text-neutral-500 mr-3"},null,-1)),st=[et],nt=A(()=>t("i",{class:"fa fa-edit text-neutral-500"},null,-1)),lt=[nt],ot={__name:"TreeItem",props:{item:Object,isChild:{type:Boolean,default:!1},level:{type:Number,default:0}},emits:["edit","add"],setup(n,{emit:T}){let p=I(!0);const d=T;function h(){p.value=!p.value}return(s,_)=>{var x;const j=z("TreeItem",!0);return l(),a("div",null,[t("div",q,[t("div",{class:k(["col-lg-3 col-9",{"child-container":n.isChild}]),style:V({paddingLeft:`${n.level*15}px`})},[t("span",{style:V({width:`${n.level*15}px`}),class:"line-connector"},null,4),n.isChild?(l(),a("span",G)):m("",!0),t("a",{onClick:g(h,["prevent"]),class:k([n.item.children?"cursor-pointer":"cursor-text","mb-2 text-black"])},[n.item.children?(l(),a("i",{key:0,class:k(["fa fa-folder mr-2 text-amber-400 text-lg",c(p)?"fa-folder-open":"fa-folder-closed"])},null,2)):m("",!0),E(" "+r(n.item.ten),1)],2)],6),t("div",J,[t("span",null,r(n.item.ngay_bat_dau),1)]),t("div",P,[t("span",null,r(n.item.ngay_ket_thuc),1)]),t("div",R,[t("span",null,[n.item.tien_do==0?(l(),a("span",W,"Chưa thực hiện")):n.item.tien_do>0&&n.item.tien_do<100?(l(),a("span",X,"Đang thực hiện")):(l(),a("span",Y,"Đã hoàn thành"))])]),t("div",Z,[t("span",null,r((x=n.item.nhan_vien)==null?void 0:x.name),1)]),t("div",tt,[t("a",{onClick:_[0]||(_[0]=g(b=>{d("add",n.item.id)},["prevent"]))},st),t("a",{onClick:_[1]||(_[1]=g(b=>{d("edit",n.item)},["prevent"]))},lt)])]),t("div",null,[c(p)?(l(!0),a(w,{key:0},C(n.item.children,b=>(l(),L(j,{"is-child":!0,level:n.level+1,key:b.id,item:b,onEdit:_[2]||(_[2]=f=>s.$emit("edit",f)),onAdd:_[3]||(_[3]=f=>s.$emit("add",f))},null,8,["level","item"]))),128)):m("",!0)])])}}},at=U(ot,[["__scopeId","data-v-54f0f5e6"]]);const u=n=>(M("data-v-375b97c4"),n=n(),O(),n),dt={id:"chitietdamodal",class:"modal fade",tabindex:"-1",style:{"z-index":"1051"},role:"dialog"},it={class:"modal-dialog modal-xl",role:"document"},ct={class:"modal-content"},ut={class:"modal-header"},_t=u(()=>t("i",{class:"fa fa-times text-lg"},null,-1)),rt=[_t],ht={class:"modal-body"},mt={class:"d-flex align-items-center"},gt=u(()=>t("label",{for:"ngay_bat_dau",class:"font-weight-bold text-secondary mt-2"},"Bắt đầu:",-1)),pt=u(()=>t("label",{for:"ngay_ket_thuc",class:"font-weight-bold text-secondary mt-2"},"Kết thúc:",-1)),bt=u(()=>t("label",{for:"user",class:"font-weight-bold text-secondary mt-2"},"Tiến độ(%):",-1)),ft={class:"mt-3"},vt=u(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success"},"Mô tả hạng mục:",-1)),yt={class:"mt-3"},xt={class:"d-flex align-items-center mb-2"},kt=u(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success mt-2"},"Attachments:",-1)),wt=u(()=>t("label",{for:"files1",class:"btn btn-dark btn-sm mt-2 ml-3"},"Chọn file",-1)),$t=u(()=>t("span",{id:"fileList",class:"d-inline-block ml-3"},null,-1)),Ct={key:0,class:"row"},Tt={class:"col-md-4"},jt={class:"card"},It={class:"card-body p-0"},St={class:"table table-striped"},Bt=u(()=>t("thead",null,[t("tr",null,[t("th",null,"File"),t("th",null,"Actions")])],-1)),Vt={style:{width:"90%"}},Et=["href"],Lt={key:0,class:"fa fa-image"},Mt={key:1,class:"fa fa-file-pdf"},Ot={key:2,class:"fa fa-file-excel"},Ut={key:1},At={style:{width:"10%"},class:"text-center"},Ft=["onClick"],Nt=u(()=>t("i",{class:"fa fa-trash"},null,-1)),zt=[Nt],Dt=["disabled"],Ht=u(()=>t("hr",null,null,-1)),Kt={class:"mt-4 mb-4",id:"subtasks"},Qt=u(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success"},"Hạng mục con:",-1)),qt={class:"mt-3 container"},Gt=u(()=>t("hr",null,null,-1)),Jt={id:"comments",class:"mt-4"},Pt={class:"font-weight-bold"},Rt={class:"card"},Wt={class:"card-body"},Xt=["src"],Yt={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 object-cover"},Zt=["value"],te=u(()=>t("input",{id:"comment",class:"form-control border-0 flex-1",placeholder:"Nhập bình luận"},null,-1)),ee=u(()=>t("button",{type:"submit",class:""},[t("i",{class:"fa fa-paper-plane text-lg text-primary"})],-1)),se={style:{"max-height":"200px",overflow:"auto"}},ne={class:""},le={class:"d-flex"},oe=["src"],ae={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},de={class:"flex-1 ml-3"},ie={class:"d-flex justify-content-between"},ce={class:"font-weight-bold"},ue={class:"text-secondary"},_e={class:"text-md"},re=u(()=>t("div",{class:"modal-footer"},null,-1)),he={__name:"ChiTiet",props:{du_an:Object,users:Object},emits:["edit","add"],setup(n,{emit:T}){const p=D(),d=n,h=I([]),s=H({id:"",ten:"",ngay_bat_dau:"",ngay_ket_thuc:"",user_id:"",mo_ta:"",tien_do:0,parent_id:"",children:[],files:[]});K(()=>{s.id=d.du_an.id,s.ten=d.du_an.ten,s.ngay_bat_dau=d.du_an.ngay_bat_dau,s.ngay_ket_thuc=d.du_an.ngay_ket_thuc,s.user_id=d.du_an.user_id,$("#user").val(d.du_an.user_id).trigger("change"),s.mo_ta=d.du_an.mo_ta,s.tien_do=d.du_an.tien_do,s.parent_id=d.du_an.parent_id,s.children=d.du_an.children,s.files=d.du_an.files,h.value=d.du_an.files});const _=()=>{s.post(route("duan.store"),{onSuccess:()=>{toastr.success("Cập nhật thành công")},onError:()=>{toastr.error("Có lỗi xảy ra, vui lòng thử lại")}})},j=()=>{$("#files1").val(""),$("#chitietdamodal").modal("hide"),s.reset(),s.clearErrors(),Q.reload()},x=i=>{confirm("Bạn có chắc chắn muốn xóa file này không?")&&(s.files=s.files.filter(o=>o.id!==i),h.value=h.value.filter(o=>o.id!==i),axios({method:"delete",url:route("duan.file.delete",{id:i})}))};function b(i){s.files=i.target.files,h.value=[...h.value,...Array.from(i.target.files).map(o=>({ten:o.name}))]}I({id:"",ten:"",ngay_bat_dau:"",ngay_ket_thuc:"",user_id:"",nhan_vien:{},mo_ta:"",tien_do:0,parent_id:"",children:[],files:[]});const f=T,F=i=>{f("edit",i)},S=i=>{f("add",i)};function N(){axios({method:"post",url:route("binhluan.store"),data:{noi_dung:$("#comment").val(),du_an_id:d.du_an.id}}).then(i=>{$("#comment").val(""),d.du_an.binh_luan.push({noi_dung:i.data.noi_dung,nguoi_dung:i.data.nguoi_dung,created_at:i.data.created_at})}).catch(i=>{console.log(i)})}return(i,o)=>(l(),a("div",dt,[t("div",it,[t("div",ct,[t("div",ut,[t("button",{type:"button",class:"close",onClick:g(j,["prevent"])},rt)]),t("form",{onSubmit:g(_,["prevent"])},[t("div",ht,[v(t("input",{type:"hidden","onUpdate:modelValue":o[0]||(o[0]=e=>c(s).id=e),id:"id",class:"form-control"},null,512),[[y,c(s).id]]),v(t("input",{type:"text",class:"font-weight-bold border-0 w-100 text-lg pl-0","onUpdate:modelValue":o[1]||(o[1]=e=>c(s).ten=e)},null,512),[[y,c(s).ten]]),t("div",mt,[gt,v(t("input",{type:"date","onUpdate:modelValue":o[2]||(o[2]=e=>c(s).ngay_bat_dau=e),id:"ngay_bat_dau",class:"border-0 mr-5 text-secondary"},null,512),[[y,c(s).ngay_bat_dau]]),pt,v(t("input",{type:"date","onUpdate:modelValue":o[3]||(o[3]=e=>c(s).ngay_ket_thuc=e),id:"ngay_ket_thuc",class:"border-0 mr-5 text-secondary"},null,512),[[y,c(s).ngay_ket_thuc]]),bt,v(t("input",{"onUpdate:modelValue":o[4]||(o[4]=e=>c(s).tien_do=e),class:"border-0 outline-0 font-bold focus:outline-0",type:"number"},null,512),[[y,c(s).tien_do]])]),t("div",ft,[vt,v(t("textarea",{"onUpdate:modelValue":o[5]||(o[5]=e=>c(s).mo_ta=e),id:"mo_ta",class:"form-control border-0 pl-0",rows:"3"},null,512),[[y,c(s).mo_ta]])]),t("div",yt,[t("div",xt,[kt,wt,t("input",{accept:".png, .jpg, .jpeg, .gif, .bmp, .doc, .docx, .xls, .xlsx, .pdf",type:"file",onInput:o[6]||(o[6]=e=>b(e)),id:"files1",class:"d-none",multiple:""},null,32),$t]),h.value.length>0?(l(),a("div",Ct,[t("div",Tt,[t("div",jt,[t("div",It,[t("table",St,[Bt,t("tbody",null,[(l(!0),a(w,null,C(h.value,e=>{var B;return l(),a("tr",{key:e.id},[t("td",Vt,[e.id?(l(),a("a",{key:0,href:`/uploads/du_an/${e.ten}`,target:"_blank",class:""},[e.ten.split(".")[e.ten.split(".").length-1]==="png"||e.ten.split(".")[e.ten.split(".").length-1]==="jpg"?(l(),a("i",Lt)):m("",!0),e.ten.split(".")[e.ten.split(".").length-1]==="pdf"||e.ten.split(".")[e.ten.split(".").length-1]==="docx"?(l(),a("i",Mt)):m("",!0),e.ten.split(".")[e.ten.split(".").length-1]==="xlsx"?(l(),a("i",Ot)):m("",!0),E(" "+r(((B=e.ten_goc)==null?void 0:B.length)>30?e.ten_goc.slice(0,30)+"...":e.ten_goc),1)],8,Et)):(l(),a("span",Ut,r(e.ten),1))]),t("td",At,[e.id?(l(),a("a",{key:0,onClick:g(me=>x(e.id),["prevent"]),class:"btn btn-sm btn-danger"},zt,8,Ft)):m("",!0)])])}),128))])])])])])])):m("",!0),t("button",{type:"submit",disabled:c(s).processing,class:"btn btn-primary right-0"},"Lưu",8,Dt),Ht,t("div",Kt,[Qt,t("a",{class:"btn btn-primary btn-sm ml-3 font-weight-bold",onClick:o[7]||(o[7]=g(e=>S(n.du_an.id),["prevent"]))},"Thêm"),t("div",qt,[(l(!0),a(w,null,C(n.du_an.children,e=>(l(),L(at,{class:"",key:e.id,item:e,onEdit:F,onAdd:S},null,8,["item"]))),128))])]),Gt,t("div",Jt,[t("p",Pt,"Bình luận ("+r(d.du_an.binh_luan.length)+")",1),t("div",Rt,[t("div",Wt,[t("div",{class:k(["d-flex",{"mb-4":d.du_an.binh_luan.length>0}])},[c(p).props.user.hinh_anh?(l(),a("img",{key:0,src:"/uploads/nhan_vien/"+c(p).props.user.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,Xt)):(l(),a("img",Yt)),t("form",{onSubmit:o[8]||(o[8]=g(e=>N(),["prevent"])),class:"flex-1 d-flex"},[t("input",{type:"hidden",value:d.du_an.id},null,8,Zt),te,ee],32)],2),t("div",se,[(l(!0),a(w,null,C(d.du_an.binh_luan,e=>(l(),a("div",ne,[t("div",le,[e.nguoi_dung.hinh_anh?(l(),a("img",{key:0,src:"/uploads/nhan_vien/"+e.nguoi_dung.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,oe)):(l(),a("img",ae)),t("div",de,[t("div",ie,[t("span",ce,r(e.nguoi_dung.name),1),t("span",ue,r(new Date(e.created_at).toLocaleString()),1)]),t("p",_e,r(e.noi_dung),1)])])]))),256))])])])])])]),re],32)])])]))}},fe=U(he,[["__scopeId","data-v-375b97c4"]]);export{fe as default};
