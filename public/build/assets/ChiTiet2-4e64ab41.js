import{Q as j,h as V,T as C,z as S,u as a,o as l,c as d,w as c,f as u,a as t,F as f,k as y,l as g,t as r,n as T,e as v,m as B,x as L,y as U}from"./app-a0d3c948.js";/* empty css                                                                 */import{_ as I}from"./_plugin-vue_export-helper-c27b6911.js";const i=h=>(L("data-v-78ef467e"),h=h(),U(),h),F={class:"d-flex align-items-center"},N=i(()=>t("label",{for:"ngay_bat_dau",class:"font-weight-bold text-secondary mt-2"},"Bắt đầu:",-1)),D=i(()=>t("label",{for:"ngay_ket_thuc",class:"font-weight-bold text-secondary mt-2"},"Kết thúc:",-1)),E=i(()=>t("label",{for:"user",class:"font-weight-bold text-secondary mt-2"},"Tiến độ:",-1)),M={class:"mt-1"},z=i(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success"},"Mô tả hạng mục:",-1)),A={class:"mt-3"},O={class:"d-flex align-items-center mb-2"},H=i(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success mt-2"},"Attachments:",-1)),K=i(()=>t("label",{for:"files1",class:"btn btn-dark btn-sm mt-2 ml-3"},"Chọn file",-1)),Q=i(()=>t("span",{id:"fileList",class:"d-inline-block ml-3"},null,-1)),X={key:0,class:"row"},q={class:"col-md-4"},G={class:"card"},J={class:"card-body p-0"},P={class:"table table-striped"},R=i(()=>t("thead",null,[t("tr",null,[t("th",null,"File")])],-1)),W={colspan:"2"},Y=["href"],Z={key:0,class:"fa fa-image"},tt={key:1,class:"fa fa-file-pdf"},et={key:2,class:"fa fa-file-excel"},st={key:1},nt=["disabled"],ot=i(()=>t("hr",null,null,-1)),at={class:"",id:"subtasks"},lt=i(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success"},"Hạng mục con:",-1)),dt=["href"],it=i(()=>t("hr",null,null,-1)),_t={id:"comments",class:""},ct={class:"font-weight-bold"},ut={class:"card"},rt={class:"card-body"},ht=["src"],pt={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 object-cover"},gt=["value"],mt=i(()=>t("input",{id:"comment",class:"form-control border-0 flex-1",placeholder:"Nhập bình luận"},null,-1)),bt=i(()=>t("button",{type:"submit",class:""},[t("i",{class:"fa fa-paper-plane text-lg text-primary"})],-1)),ft={style:{"max-height":"200px",overflow:"auto"}},yt={class:""},vt={class:"d-flex"},xt=["src"],kt={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},wt={class:"flex-1 ml-3"},jt={class:"d-flex justify-content-between"},Vt={class:"font-weight-bold"},Ct={class:"text-secondary"},St={class:"text-md"},Tt={__name:"ChiTiet2",props:{du_an:Object,users:Object},setup(h){const m=j(),n=h,p=V([]),s=C({id:"",ten:"",ngay_bat_dau:"",ngay_ket_thuc:"",user_id:"",mo_ta:"",trang_thai:"",parent_id:"",children:[],files:[],binh_luan:[],tien_do:0});S(()=>{s.id=n.du_an.id,s.ten=n.du_an.ten,s.ngay_bat_dau=n.du_an.ngay_bat_dau,s.ngay_ket_thuc=n.du_an.ngay_ket_thuc,s.user_id=n.du_an.user_id,$("#user").val(n.du_an.user_id).trigger("change"),s.mo_ta=n.du_an.mo_ta,s.trang_thai=n.du_an.trang_thai,s.parent_id=n.du_an.parent_id,s.children=n.du_an.children,s.files=n.du_an.files,p.value=n.du_an.files,s.binh_luan=n.du_an.binh_luan,s.tien_do=n.du_an.tien_do});const x=()=>{s.post(route("duan.store"),{onSuccess:()=>{toastr.success("Cập nhật thành công")},onError:_=>{console.log(_),toastr.error("Có lỗi xảy ra, vui lòng thử lại")}})};function k(_){s.files=_.target.files,p.value=[...p.value,...Array.from(_.target.files).map(o=>({ten:o.name}))]}function w(){axios({method:"post",url:route("binhluan.store"),data:{noi_dung:$("#comment").val(),du_an_id:n.du_an.id}}).then(_=>{$("#comment").val(""),n.du_an.binh_luan.push({noi_dung:_.data.noi_dung,nguoi_dung:_.data.nguoi_dung,created_at:_.data.created_at})}).catch(_=>{console.log(_)})}return(_,o)=>a(s).id?(l(),d("form",{key:0,onSubmit:v(x,["prevent"])},[c(t("input",{type:"hidden","onUpdate:modelValue":o[0]||(o[0]=e=>a(s).id=e),id:"id",class:"form-control"},null,512),[[u,a(s).id]]),c(t("input",{readonly:"",type:"text",class:"font-weight-bold border-0 w-100 text-lg pl-0 pb-0","onUpdate:modelValue":o[1]||(o[1]=e=>a(s).ten=e)},null,512),[[u,a(s).ten]]),t("div",F,[N,c(t("input",{readonly:"",type:"date","onUpdate:modelValue":o[2]||(o[2]=e=>a(s).ngay_bat_dau=e),id:"ngay_bat_dau",class:"border-0 mr-3 text-secondary"},null,512),[[u,a(s).ngay_bat_dau]]),D,c(t("input",{readonly:"",type:"date","onUpdate:modelValue":o[3]||(o[3]=e=>a(s).ngay_ket_thuc=e),id:"ngay_ket_thuc",class:"border-0 mr-3 text-secondary"},null,512),[[u,a(s).ngay_ket_thuc]]),E,c(t("input",{"onUpdate:modelValue":o[4]||(o[4]=e=>a(s).tien_do=e),class:"border-0 outline-0 font-bold focus:outline-0",type:"number"},null,512),[[u,a(s).tien_do]])]),t("div",M,[z,c(t("textarea",{readonly:"","onUpdate:modelValue":o[5]||(o[5]=e=>a(s).mo_ta=e),id:"mo_ta",class:"form-control border-0 pl-0",rows:"3"},null,512),[[u,a(s).mo_ta]])]),t("div",A,[t("div",O,[H,K,t("input",{accept:".png, .jpg, .jpeg, .gif, .bmp, .doc, .docx, .xls, .xlsx, .pdf",type:"file",onInput:o[6]||(o[6]=e=>k(e)),id:"files1",class:"d-none",multiple:""},null,32),Q]),p.value.length>0?(l(),d("div",X,[t("div",q,[t("div",G,[t("div",J,[t("table",P,[R,t("tbody",null,[(l(!0),d(f,null,y(p.value,e=>{var b;return l(),d("tr",{key:e.id},[t("td",W,[e.id?(l(),d("a",{key:0,href:`/uploads/du_an/${e.ten}`,target:"_blank",class:""},[e.ten.split(".")[e.ten.split(".").length-1]==="png"||e.ten.split(".")[e.ten.split(".").length-1]==="jpg"?(l(),d("i",Z)):g("",!0),e.ten.split(".")[e.ten.split(".").length-1]==="pdf"||e.ten.split(".")[e.ten.split(".").length-1]==="docx"?(l(),d("i",tt)):g("",!0),e.ten.split(".")[e.ten.split(".").length-1]==="xlsx"?(l(),d("i",et)):g("",!0),B(" "+r(((b=e.ten_goc)==null?void 0:b.length)>30?e.ten_goc.slice(0,30)+"...":e.ten_goc),1)],8,Y)):(l(),d("span",st,r(e.ten),1))])])}),128))])])])])])])):g("",!0),t("button",{type:"submit",disabled:a(s).processing,class:"btn btn-primary right-0 font-weight-bold"},"Lưu",8,nt),ot,t("div",at,[lt,t("a",{class:"btn btn-primary btn-sm ml-3 font-weight-bold",href:_.route("duan.detail",{id:a(s).id})},"Xem chi tiết",8,dt)]),it,t("div",_t,[t("p",ct,"Bình luận ("+r(n.du_an.binh_luan.length)+")",1),t("div",ut,[t("div",rt,[t("div",{class:T(["d-flex",{"mb-4":n.du_an.binh_luan.length>0}])},[a(m).props.user.hinh_anh?(l(),d("img",{key:0,src:"/uploads/nhan_vien/"+a(m).props.user.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,ht)):(l(),d("img",pt)),t("form",{onSubmit:o[7]||(o[7]=v(e=>w(),["prevent"])),class:"flex-1 d-flex"},[t("input",{type:"hidden",value:n.du_an.id},null,8,gt),mt,bt],32)],2),t("div",ft,[(l(!0),d(f,null,y(n.du_an.binh_luan,e=>(l(),d("div",yt,[t("div",vt,[e.nguoi_dung.hinh_anh?(l(),d("img",{key:0,src:"/uploads/nhan_vien/"+e.nguoi_dung.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,xt)):(l(),d("img",kt)),t("div",wt,[t("div",jt,[t("span",Vt,r(e.nguoi_dung.name),1),t("span",Ct,r(new Date(e.created_at).toLocaleString()),1)]),t("p",St,r(e.noi_dung),1)])])]))),256))])])])])])],32)):g("",!0)}},It=I(Tt,[["__scopeId","data-v-78ef467e"]]);export{It as default};
