import{Q as j,h as V,T as S,z as B,u as a,o as i,c as _,w as c,f as p,a as t,B as y,F as g,k as b,l as m,t as h,n as U,e as f,x as L,y as T}from"./app-53c49383.js";/* empty css                                                                 */import{_ as F}from"./_plugin-vue_export-helper-c27b6911.js";const l=r=>(L("data-v-0d93d222"),r=r(),T(),r),I={class:"d-flex align-items-center"},D=l(()=>t("label",{for:"ngay_bat_dau",class:"font-weight-bold text-secondary mt-2"},"Bắt đầu:",-1)),M=l(()=>t("label",{for:"ngay_ket_thuc",class:"font-weight-bold text-secondary mt-2"},"Kết thúc:",-1)),N=l(()=>t("label",{class:"font-weight-bold text-secondary mt-2"},"Tình trạng",-1)),A=l(()=>t("option",{value:"0"},"Chưa thực hiện",-1)),E=l(()=>t("option",{value:"1"},"Đang thực hiện",-1)),z=l(()=>t("option",{value:"2"},"Đã hoàn thành",-1)),O=[A,E,z],H=l(()=>t("label",{for:"user",class:"font-weight-bold text-secondary mt-2"},"Người thực hiện:",-1)),K=["value"],Q={class:"mt-1"},X=l(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success"},"Mô tả hạng mục:",-1)),q={class:"mt-3"},G={class:"d-flex align-items-center mb-2"},J=l(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success mt-2"},"Attachments:",-1)),P=l(()=>t("label",{for:"files1",class:"btn btn-success btn-sm mt-2 ml-3"},"Chọn file",-1)),R=l(()=>t("span",{id:"fileList",class:"d-inline-block ml-3"},null,-1)),W={key:0,class:"row"},Y={class:"col-md-4"},Z={class:"card"},tt={class:"card-body p-0"},et={class:"table table-striped"},nt=l(()=>t("thead",null,[t("tr",null,[t("th",null,"File"),t("th",null,"Actions")])],-1)),st={class:"d-flex gap-[5px] justify-content-center"},ot=["href"],at=["onClick"],lt=["disabled"],dt=l(()=>t("hr",null,null,-1)),it={class:"",id:"subtasks"},_t=l(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success"},"Hạng mục con:",-1)),ut=["href"],ct=l(()=>t("hr",null,null,-1)),rt={id:"comments",class:""},ht={class:"font-weight-bold"},pt={class:"card"},mt={class:"card-body"},gt=["src"],bt={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 object-cover"},ft=["value"],vt=l(()=>t("input",{id:"comment",class:"form-control border-0 flex-1",placeholder:"Nhập bình luận"},null,-1)),yt=l(()=>t("button",{type:"submit",class:""},[t("i",{class:"fa fa-paper-plane text-lg text-primary"})],-1)),xt={style:{"max-height":"200px",overflow:"auto"}},wt={class:""},kt={class:"d-flex"},Ct=["src"],jt={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},Vt={class:"flex-1 ml-3"},St={class:"d-flex justify-content-between"},Bt={class:"font-weight-bold"},Ut={class:"text-secondary"},Lt={class:"text-md"},Tt={__name:"ChiTiet2",props:{du_an:Object,users:Object},setup(r){const v=j(),o=r,u=V([]),n=S({id:"",ten:"",ngay_bat_dau:"",ngay_ket_thuc:"",user_id:"",mo_ta:"",trang_thai:"",parent_id:"",children:[],files:[],binh_luan:[]});B(()=>{n.id=o.du_an.id,n.ten=o.du_an.ten,n.ngay_bat_dau=o.du_an.ngay_bat_dau,n.ngay_ket_thuc=o.du_an.ngay_ket_thuc,n.user_id=o.du_an.user_id,$("#user").val(o.du_an.user_id).trigger("change"),n.mo_ta=o.du_an.mo_ta,n.trang_thai=o.du_an.trang_thai,n.parent_id=o.du_an.parent_id,n.children=o.du_an.children,n.files=o.du_an.files,u.value=o.du_an.files,n.binh_luan=o.du_an.binh_luan});const x=()=>{n.post(route("duan.store"),{onSuccess:()=>{toastr.success("Cập nhật thành công")},onError:d=>{console.log(d),toastr.error("Có lỗi xảy ra, vui lòng thử lại")}})},w=d=>{confirm("Bạn có chắc chắn muốn xóa file này không?")&&(n.files=n.files.filter(s=>s.id!==d),u.value=u.value.filter(s=>s.id!==d),axios({method:"delete",url:route("duan.file.delete",{id:d})}))};function k(d){n.files=d.target.files,u.value=[...u.value,...Array.from(d.target.files).map(s=>({ten:s.name}))]}function C(){axios({method:"post",url:route("binhluan.store"),data:{noi_dung:$("#comment").val(),du_an_id:o.du_an.id}}).then(d=>{$("#comment").val(""),o.du_an.binh_luan.push({noi_dung:d.data.noi_dung,nguoi_dung:d.data.nguoi_dung,created_at:d.data.created_at})}).catch(d=>{console.log(d)})}return(d,s)=>a(n).id?(i(),_("form",{key:0,onSubmit:f(x,["prevent"])},[c(t("input",{type:"hidden","onUpdate:modelValue":s[0]||(s[0]=e=>a(n).id=e),id:"id",class:"form-control"},null,512),[[p,a(n).id]]),c(t("input",{type:"text",class:"font-weight-bold border-0 text-lg pl-0 pb-0","onUpdate:modelValue":s[1]||(s[1]=e=>a(n).ten=e)},null,512),[[p,a(n).ten]]),t("div",I,[D,c(t("input",{type:"date","onUpdate:modelValue":s[2]||(s[2]=e=>a(n).ngay_bat_dau=e),id:"ngay_bat_dau",class:"border-0 mr-3 text-secondary"},null,512),[[p,a(n).ngay_bat_dau]]),M,c(t("input",{type:"date","onUpdate:modelValue":s[3]||(s[3]=e=>a(n).ngay_ket_thuc=e),id:"ngay_ket_thuc",class:"border-0 mr-3 text-secondary"},null,512),[[p,a(n).ngay_ket_thuc]]),N,c(t("select",{"onUpdate:modelValue":s[4]||(s[4]=e=>a(n).trang_thai=e),class:"border-0 active:outline-0 outline-0 focus:outline-0 mr-3 font-bold",id:"trang_thai"},O,512),[[y,a(n).trang_thai]]),H,c(t("select",{"onUpdate:modelValue":s[5]||(s[5]=e=>a(n).user_id=e),class:"border-0 outline-0 font-bold focus:outline-0",id:"user"},[(i(!0),_(g,null,b(r.users,e=>(i(),_("option",{value:e.id},h(e.name),9,K))),256))],512),[[y,a(n).user_id]])]),t("div",Q,[X,c(t("textarea",{"onUpdate:modelValue":s[6]||(s[6]=e=>a(n).mo_ta=e),id:"mo_ta",class:"form-control border-0 pl-0",rows:"3"},null,512),[[p,a(n).mo_ta]])]),t("div",q,[t("div",G,[J,P,t("input",{accept:".png, .jpg, .jpeg, .gif, .bmp, .doc, .docx, .xls, .xlsx, .pdf",type:"file",onInput:s[7]||(s[7]=e=>k(e)),id:"files1",class:"d-none",multiple:""},null,32),R]),u.value.length>0?(i(),_("div",W,[t("div",Y,[t("div",Z,[t("div",tt,[t("table",et,[nt,t("tbody",null,[(i(!0),_(g,null,b(u.value,e=>(i(),_("tr",{key:e.id},[t("td",null,h(e.ten.length>30?e.ten.slice(0,30)+"...":e.ten),1),t("td",st,[e.id?(i(),_("a",{key:0,href:`/uploads/du_an/${e.ten}`,target:"_blank",class:"btn btn-primary btn-sm"},"View",8,ot)):m("",!0),e.id?(i(),_("a",{key:1,onClick:f($t=>w(e.id),["prevent"]),class:"btn btn-sm btn-danger"},"Delete",8,at)):m("",!0)])]))),128))])])])])])])):m("",!0),t("button",{type:"submit",disabled:a(n).processing,class:"btn btn-primary right-0"},"Lưu",8,lt),dt,t("div",it,[_t,t("a",{class:"btn btn-primary btn-sm ml-3 font-weight-bold",href:d.route("duan.detail",{id:a(n).id})},"Xem chi tiết",8,ut)]),ct,t("div",rt,[t("p",ht,"Bình luận ("+h(o.du_an.binh_luan.length)+")",1),t("div",pt,[t("div",mt,[t("div",{class:U(["d-flex",{"mb-4":o.du_an.binh_luan.length>0}])},[a(v).props.user.hinh_anh?(i(),_("img",{key:0,src:"/uploads/nhan_vien/"+a(v).props.user.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,gt)):(i(),_("img",bt)),t("form",{onSubmit:s[8]||(s[8]=f(e=>C(),["prevent"])),class:"flex-1 d-flex"},[t("input",{type:"hidden",value:o.du_an.id},null,8,ft),vt,yt],32)],2),t("div",xt,[(i(!0),_(g,null,b(o.du_an.binh_luan,e=>(i(),_("div",wt,[t("div",kt,[e.nguoi_dung.hinh_anh?(i(),_("img",{key:0,src:"/uploads/nhan_vien/"+e.nguoi_dung.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,Ct)):(i(),_("img",jt)),t("div",Vt,[t("div",St,[t("span",Bt,h(e.nguoi_dung.name),1),t("span",Ut,h(new Date(e.created_at).toLocaleString()),1)]),t("p",Lt,h(e.noi_dung),1)])])]))),256))])])])])])],32)):m("",!0)}},Mt=F(Tt,[["__scopeId","data-v-0d93d222"]]);export{Mt as default};
