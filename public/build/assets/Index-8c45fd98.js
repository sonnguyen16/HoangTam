import{Q as z,h as k,T as H,i as R,j as G,o as a,b as J,d as K,a as t,e as _,w as j,f as C,u as i,p as W,c as l,k as b,F as m,g as T,m as g,t as c,l as p,n as I,O as L,x as X,y as Y}from"./app-451a1b70.js";import{_ as Z}from"./MainLayout-a50f36ad.js";import tt from"./DeXuatModal-23ab6432.js";import{f as V}from"./script-4eb152de.js";import{_ as et}from"./Pagination-46473f38.js";import{_ as st}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                     *//* empty css              */const d=u=>(X("data-v-4512a832"),u=u(),Y(),u),nt=d(()=>t("div",{class:"card shadow"},[t("div",{class:"card-body card-brc"},[t("p",{class:"txt-color mb-0 font-weight-bold"},[g("Danh mục quản lý "),t("i",{class:"fa fa-angle-right mr-2 ml-2"}),g(" Quản lý đề xuất")])])],-1)),ot={class:"card shadow card-child",style:{}},at={class:"card-body p-0"},it={class:"row"},lt={class:"col-md-3"},dt={class:"row"},ct={class:"col-md-4"},_t={class:"col-md-8 pt-3 pl-3"},rt={class:"input-group"},ut=d(()=>t("div",{class:"input-group-append"},[t("button",{class:"btn btn-primary",type:"submit"},[t("i",{class:"fas fa-search"})])],-1)),ht=d(()=>t("h4",{class:"txt-color font-weight-bold ml-3 mb-3"},"Danh sách đề xuất",-1)),mt=["onClick"],pt={class:"d-flex align-items-center gap-[10px] ms-1"},gt=["id","checked"],ft={class:"font-bold mb-0 mt-[2px]"},bt={class:"mb-0 ms-1 mt-2 text-secondary"},vt={class:"d-flex justify-content-between align-items-center mt-2 mb-0"},xt={class:"d-flex align-items-center gap-[5px]"},yt=["src"],wt={key:1,src:"/uploads/avatardefault.png",alt:"",class:"object-cover",style:{width:"30px",height:"30px"}},kt={class:"text-secondary"},jt={class:"text-secondary"},Ct={class:"col-md-7 p-3"},Nt={class:"text-secondary"},$t={key:0,class:"text-danger ml-1"},Dt={key:1,class:"text-success ml-1"},St=d(()=>t("h5",{class:"mb-0 mt-3"},"Thông tin đề xuất",-1)),Tt=d(()=>t("hr",{class:"mt-2 mb-3"},null,-1)),It={class:"text-secondary"},Lt={class:"text-md"},Vt=d(()=>t("i",{class:"fa fa-user me-2"},null,-1)),Bt={class:"font-weight-bold text-black ms-2 text-md"},Ft={class:"text-md mb-2"},Mt=d(()=>t("i",{class:"fa fa-clock me-2"},null,-1)),Ot={class:"ms-2 text-md text-black"},At={class:"d-flex"},Ut=d(()=>t("span",{class:"text-md me-1 mt-2"},[t("i",{class:"fa fa-file flex-1 me-2"}),g(" Nội dung: ")],-1)),Et=d(()=>t("h5",{class:"mb-0 mt-3"},"File đính kèm",-1)),Pt=d(()=>t("hr",{class:"mt-2 mb-3"},null,-1)),Qt={class:"mt-3"},qt={class:"d-flex align-items-center mb-2"},zt=d(()=>t("label",{for:"mo_ta",class:"font-weight-bold text-success mt-2"},"Attachments:",-1)),Ht=d(()=>t("label",{for:"files2",class:"btn btn-success btn-sm mt-2 ml-3"},"Chọn file",-1)),Rt=d(()=>t("span",{id:"fileList",class:"d-inline-block ml-3"},null,-1)),Gt={key:0,class:"row"},Jt={class:"col-md-5"},Kt={class:"card"},Wt={class:"card-body p-0"},Xt={class:"table table-striped"},Yt=d(()=>t("thead",null,[t("tr",null,[t("th",null,"File"),t("th",null,"Actions")])],-1)),Zt={class:"d-flex gap-[5px] justify-content-center"},te=["href"],ee=["onClick"],se=["disabled"],ne=d(()=>t("h5",{class:"mb-0 mt-3"},"Bình luận",-1)),oe=d(()=>t("hr",{class:"mt-2 mb-3"},null,-1)),ae={class:"card elevation-2"},ie={class:"card-body"},le=["src"],de={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 object-cover"},ce=["value"],_e=d(()=>t("input",{id:"comment",class:"form-control border-0 flex-1",placeholder:"Nhập bình luận"},null,-1)),re=d(()=>t("button",{type:"submit",class:""},[t("i",{class:"fa fa-paper-plane text-lg text-primary"})],-1)),ue={class:""},he={class:"d-flex"},me=["src"],pe={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},ge={class:"flex-1 ml-3"},fe={class:"d-flex justify-content-between"},be={class:"font-weight-bold"},ve={class:"text-secondary"},xe={class:"text-md"},ye={class:"col-md-2 pt-3 pr-4"},we={class:"card p-3 elevation-2"},ke={class:"d-flex justify-content-between align-items-center"},je=d(()=>t("h5",{class:"font-weight-bold mb-0"},"Người duyệt",-1)),Ce=d(()=>t("hr",{class:"mt-1 mb-2"},null,-1)),Ne={class:"d-flex align-items-center gap-[10px] my-1"},$e=["src"],De={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},Se={class:"font-weight-bold"},Te={class:"card p-3 elevation-2"},Ie={class:"d-flex justify-content-between align-items-center"},Le=d(()=>t("h5",{class:"font-weight-bold mb-0"},"Người theo dõi",-1)),Ve=d(()=>t("hr",{class:"mt-1 mb-2"},null,-1)),Be={class:"d-flex align-items-center justify-content-between my-1"},Fe=["src"],Me={key:1,src:"/uploads/avatardefault.png",alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},Oe={class:"font-weight-bold"},Ae=["onClick"],Ue={__name:"Index",props:{de_xuat_list:Object,nhan_vien_list:Object},setup(u){const B=u,v=z();let x=k({id:"",ten:"",noi_dung:"",nguoi_duyet:"",nguoi_theo_doi:[],file:"",trang_thai:0}),s=H({id:"",ten:"",noi_dung:"",nguoi_duyet:{},nguoi_theo_doi:[],created_at:"",trang_thai:0,created_by:{},files:[],binh_luan:[]}),f=k(""),r=k([]);function F(){x.value={id:"",ten:"",noi_dung:"",nguoi_duyet:"",nguoi_theo_doi:[],file:"",trang_thai:0},$("#dexuatmodal").modal("show")}const y=R(()=>B.de_xuat_list);G(f,n=>{L.visit(route("dexuat.index",{search:n}),{preserveState:!0})});function M(n){L.visit(n,{preserveState:!0})}function O(n){s.id=n.id,s.ten=n.ten,s.noi_dung=n.noi_dung,s.nguoi_duyet=n.nguoi_duyet,s.nguoi_theo_doi=n.nguoi_theo_doi,s.trang_thai=n.trang_thai,s.created_by=n.created_by,s.created_at=n.created_at,s.files=n.files,s.binh_luan=n.binh_luan,r.value=n.files.map(o=>({id:o.id,ten:o.ten}))}function A(){axios({method:"post",url:route("binhluan.store"),data:{noi_dung:$("#comment").val(),de_xuat_id:s.id}}).then(n=>{$("#comment").val(""),s.binh_luan.push({noi_dung:n.data.noi_dung,nguoi_dung:n.data.nguoi_dung,created_at:n.data.created_at})}).catch(n=>{console.log(n)})}function U(n){axios({method:"post",url:route("dexuat.duyet",{id:n.target.id}),data:{trang_thai:n.target.checked?1:0}}).then(o=>{s.trang_thai=o.data.trang_thai,o.data.trang_thai===1?toastr.success("Duyệt đề xuất thành công"):toastr.success("Hủy duyệt đề xuất thành công")}).catch(o=>{console.log(o)})}const E=()=>{s.post(route("dexuat.store"),{onSuccess:()=>{toastr.success("Lưu đề xuất thành công")},onError:()=>{toastr.error("Lưu đề xuất thất bại"),console.log(s.errors)}})},P=n=>{confirm("Bạn có chắc chắn muốn xóa file này không?")&&(s.files=s.files.filter(o=>o.id!=n),r.value=r.value.filter(o=>o.id!=n),y.value.data.find(o=>o.id===s.id).files=s.files,axios({method:"delete",url:route("duan.file.delete",{id:n})}))};function Q(n){s.files=n.target.files,r.value=[...r.value,...Array.from(n.target.files).map(o=>({ten:o.name}))]}function N(){x.value={id:s.id,ten:s.ten,noi_dung:s.noi_dung,nguoi_duyet:s.nguoi_duyet,nguoi_theo_doi:[],file:[]},$("#dexuatmodal").modal("show")}function q(n){s.nguoi_theo_doi=s.nguoi_theo_doi.filter(o=>o.id!=n),axios({method:"post",url:route("dexuat.xoatheodoi",{id:n})})}return(n,o)=>(a(),J(Z,null,{default:K(()=>{var D,S;return[nt,t("div",ot,[t("div",at,[t("div",it,[t("div",lt,[t("div",dt,[t("div",ct,[t("a",{onClick:_(F,["prevent"]),class:"btn btn-primary form-control m-3"},"Thêm đề xuất")]),t("div",_t,[t("div",rt,[j(t("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>W(f)?f.value=e:f=e),type:"text",name:"search",class:"form-control",placeholder:"Tìm kiếm đề xuất"},null,512),[[C,i(f)]]),ut])])]),ht,(a(!0),l(m,null,b(y.value.data,e=>(a(),l("div",{onClick:h=>O(e),class:I(["p-3 border-bottom",{"bg-blue-200":i(s).id===e.id},{"bg-neutral-100 ":i(s).id!==e.id}])},[t("div",pt,[e.nguoi_duyet.id===i(v).props.user.id?(a(),l("input",{key:0,id:e.id,onChange:_(U,["prevent"]),type:"checkbox",checked:e.trang_thai==1},null,40,gt)):p("",!0),t("h5",ft,c(e.ten),1)]),t("p",bt,c(e.noi_dung.length>100?e.noi_dung.slice(0,100)+"...":e.noi_dung),1),t("div",vt,[t("div",xt,[e.created_by.hinh_anh?(a(),l("img",{key:0,src:"/uploads/nhan_vien/"+e.created_by.hinh_anh,alt:"",class:"object-cover",style:{width:"50px",height:"50px"}},null,8,yt)):(a(),l("img",wt)),t("span",kt,c(e.created_by.name),1)]),t("span",jt,c(i(V)(e.created_at)),1)])],10,mt))),256)),T(et,{"all-data":y.value,onChangePage:M},null,8,["all-data"])]),t("div",Ct,[i(s).id?(a(),l(m,{key:0},[t("form",{onSubmit:_(E,["prevent"])},[j(t("input",{class:"w-100 font-weight-bold border-0 text-[20px] active:outline-0 p-0 pb-2","onUpdate:modelValue":o[1]||(o[1]=e=>i(s).ten=e)},null,512),[[C,i(s).ten]]),t("p",Nt,[g("Trạng thái: "),i(s).trang_thai===String(0)?(a(),l("span",$t,"Chưa duyệt")):(a(),l("span",Dt,"Đã duyệt"))]),St,Tt,t("div",It,[t("p",Lt,[Vt,g(" Người tạo: "),t("span",Bt,c(i(s).created_by.name),1)]),t("p",Ft,[Mt,g(" Ngày tạo: "),t("span",Ot,c(i(V)(i(s).created_at)),1)]),t("div",At,[Ut,j(t("textarea",{rows:"5","onUpdate:modelValue":o[2]||(o[2]=e=>i(s).noi_dung=e),class:"text-md text-black form-control w-75 border-0"},null,512),[[C,i(s).noi_dung]])])]),Et,Pt,t("div",Qt,[t("div",qt,[zt,Ht,t("input",{accept:".png, .jpg, .jpeg, .gif, .bmp, .doc, .docx, .xls, .xlsx, .pdf",type:"file",onInput:o[3]||(o[3]=e=>Q(e)),id:"files2",class:"d-none",multiple:""},null,32),Rt]),i(r).length>0?(a(),l("div",Gt,[t("div",Jt,[t("div",Kt,[t("div",Wt,[t("table",Xt,[Yt,t("tbody",null,[(a(!0),l(m,null,b(i(r),e=>{var h;return a(),l("tr",{key:e.id},[t("td",null,c(((h=e.ten)==null?void 0:h.length)>30?e.ten.slice(0,30)+"...":e.ten),1),t("td",Zt,[e.id?(a(),l("a",{key:0,href:`/uploads/de_xuat/${e.ten}`,target:"_blank",class:"btn btn-primary btn-sm"},"View",8,te)):p("",!0),e.id?(a(),l("a",{key:1,onClick:_(w=>P(e.id),["prevent"]),class:"btn btn-sm btn-danger"},"Delete",8,ee)):p("",!0)])])}),128))])])])])])])):p("",!0),t("button",{disabled:i(s).processing,type:"submit",class:"btn btn-primary right-0"},"Lưu",8,se)])],32),ne,oe,t("div",ae,[t("div",ie,[t("div",{class:I(["d-flex",{"mb-4":i(s).binh_luan.length>0}])},[i(v).props.user.hinh_anh?(a(),l("img",{key:0,src:"/uploads/nhan_vien/"+i(v).props.user.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,le)):(a(),l("img",de)),t("form",{onSubmit:_(A,["prevent"]),class:"flex-1 d-flex"},[t("input",{type:"hidden",value:i(s).id},null,8,ce),_e,re],32)],2),(a(!0),l(m,null,b(i(s).binh_luan,e=>(a(),l("div",ue,[t("div",he,[e.nguoi_dung.hinh_anh?(a(),l("img",{key:0,src:"/uploads/nhan_vien/"+e.nguoi_dung.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover"},null,8,me)):(a(),l("img",pe)),t("div",ge,[t("div",fe,[t("span",be,c(e.nguoi_dung.name),1),t("span",ve,c(new Date(e.created_at).toLocaleString()),1)]),t("p",xe,c(e.noi_dung),1)])])]))),256))])])],64)):p("",!0)]),t("div",ye,[i(s).id?(a(),l(m,{key:0},[t("div",we,[t("div",ke,[je,t("button",{onClick:o[4]||(o[4]=_(e=>N(),["prevent"])),class:"fa fa-edit text-secondary"})]),Ce,t("div",Ne,[(D=i(s).nguoi_duyet)!=null&&D.hinh_anh?(a(),l("img",{key:0,src:"/uploads/nhan_vien/"+i(s).nguoi_duyet.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover elevation-2"},null,8,$e)):(a(),l("img",De)),t("span",Se,c((S=i(s).nguoi_duyet)==null?void 0:S.name),1)])]),t("div",Te,[t("div",Ie,[Le,t("button",{onClick:o[5]||(o[5]=_(e=>N(),["prevent"])),class:"fa fa-edit text-secondary"})]),Ve,(a(!0),l(m,null,b(i(s).nguoi_theo_doi,e=>{var h,w;return a(),l("div",Be,[(a(),l("div",{key:e.id,class:"d-flex align-items-center gap-[10px]"},[(h=e.user)!=null&&h.hinh_anh?(a(),l("img",{key:0,src:"/uploads/nhan_vien/"+e.user.hinh_anh,alt:"avatar",class:"rounded-full w-10 h-10 object-cover elevation-2"},null,8,Fe)):(a(),l("img",Me)),t("span",Oe,c((w=e.user)==null?void 0:w.name),1)])),t("button",{onClick:_(Ee=>q(e.id),["prevent"]),class:"fa fa-trash text-secondary"},null,8,Ae)])}),256))])],64)):p("",!0)])])])]),T(tt,{de_xuat:i(x),nhan_vien_list:u.nhan_vien_list},null,8,["de_xuat","nhan_vien_list"])]}),_:1}))}},Ke=st(Ue,[["__scopeId","data-v-4512a832"]]);export{Ke as default};
